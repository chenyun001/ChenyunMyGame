---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Administrator.
--- DateTime: 2021/11/17 17:24
---

local view = {}
local event_system = require "manager/event"
local messages = {}
local rolling = false
function view:awake()
    self.transform.parent = self.transform.parent.parent
    self.text = self.transform:Find("Mask_Image/RaceLamp_text2"):GetComponent(typeof(UnityEngine.UI.Text))
    event_system:add_listener(NetWorkEvent.RollingNotice,function(msg)
        self:set_message(msg)
    end)
    self.gameObject:SetActive(false)
    
end

---@param msg proto.notice.PushRollingNotice
function view:set_message(msg)
    table.insert(messages,msg) 
    table.sort(messages,function(a,b) return a.priority<b.priority end)
        if (rolling==false) then self:show_message() end
end

function view:show_message()
    if (table.size(messages)>0) then
        rolling = true
        self.gameObject:SetActive(true)
        self.text.text = messages[1].text
        table.remove(messages,1)
        DoTweenBridge.Line(300,-850,6,function(value)
            self.text.gameObject:SetLocalXYZ(value,0,0)
        end,function() self:show_message() end)
    else
        self.gameObject:SetActive(false)
        rolling = false
    end
    



end

function view:start()
    
end

return view